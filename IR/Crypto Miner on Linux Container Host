# ğŸ›¡ Crypto Miner on Linux Container Host

## ğŸ“Œ Executive Summary
During log review, unusual CPU spikes were observed on a Kubernetes worker node. Investigation revealed a crypto miner binary (`xmrig`) deployed via a misconfigured container. The attacker exploited exposed Docker API to deploy the container.

**ğŸ¯ Outcome:** resource hijacking detected, miner removed, exposure closed.

---

## ğŸ–¼ Attack Flow (ASCII Diagram)

+---------------------------+
| Exposed Docker API Port   |
+---------------------------+
             |
             v
+---------------------------+
| Attacker Deployed Malic.  |
| Container (xmrig)         |
+---------------------------+
             |
             v
+---------------------------+
| High CPU Usage            |
| & Outbound Pool Traffic   |
+---------------------------+
             |
             v
+---------------------------+
| SOC Alert â†’ Investigation |
+---------------------------+
             |
             v
+---------------------------+
| Container Removed, Port   |
| Secured                   |
+---------------------------+

---

## â± Timeline (UTC)
- 02:41 â€“ Metrics show CPU usage 95% on worker node.  
- 02:44 â€“ Netflow reveals mining pool connections.  
- 02:50 â€“ Analyst confirms xmrig binary inside container.  
- 03:05 â€“ Container killed; port closed.  
- 03:30 â€“ Post-mortem + K8s audit logs reviewed.  

---

## ğŸ”‘ Key Findings
- Docker API exposed to internet without auth.  
- Miner pulled from public registry.  
- Traffic to Monero pool detected.  

---

## ğŸ—‚ï¸ MITRE ATT&CK Mapping
- **T1190 â€“ Exploit Public-Facing Application**  
- **T1496 â€“ Resource Hijacking**  
- **T1105 â€“ Ingress Tool Transfer**  

---

## ğŸ‘€ Detection Use Cases
- Monitor abnormal CPU / GPU spikes.  
- Alert on containers pulling suspicious images.  
- Detect outbound to known mining pools.  

---

## ğŸ›¡ï¸ Recommendations
- Restrict Docker API access.  
- Enable authentication for container deployments.  
- Build detections for mining indicators in SIEM.  
