ğŸ›¡ Unauthorized Lateral Movement via PSExec (Anonymized)
ğŸ“Œ Executive Summary

EDR detected suspicious use of PSExec originating from a finance department workstation targeting a file server.
Stolen domain admin credentials were leveraged in the attempt.
The intrusion was blocked before persistence, malware deployment, or exfiltration occurred.

ğŸ¯ Outcome: lateral movement blocked, credentials reset, no data loss.

_______________________________________________________________________________________________________________________________________________

ğŸ–¼ Attack Flow (ASCII Diagram)

+---------------------------+
| Compromised Workstation   |
| (Finance Dept)            |
+---------------------------+
             |
             v
+---------------------------+
| Attacker Runs PSExec      |
| w/ Stolen Domain Creds    |
+---------------------------+
             |
             v
+---------------------------+
| Connection Attempt to     |
| File Server               |
+---------------------------+
             |
             v
+---------------------------+
| ğŸš¨ EDR Alert â†’ SOC IR     |
+---------------------------+
             |
             v
+---------------------------+
| Account Disabled +        |
| Lateral Move Stopped      |
+---------------------------+

_______________________________________________________________________________________________________________________________________________

ğŸ“– Attack Narrative

ğŸ¥· Stage 1 â€“ Initial Execution

Finance workstation compromised (likely via phishing/malware).

PSExec binary launched with stolen domain admin creds.


ğŸŒ Stage 2 â€“ Lateral Movement Attempt

Targeted file server via admin$ SMB share.

Command-line args matched remote service execution pattern.


ğŸ›¡ Stage 3 â€“ Containment

EDR flagged PSExec use from non-IT host.

SOC validated suspicious creds usage.

Workstation isolated, creds disabled.

No persistence or malicious files on server.

_______________________________________________________________________________________________________________________________________________

â± Timeline (UTC)

| Time  | Event                                                         |
| ----- | ------------------------------------------------------------- |
| 18:04 | ğŸš¨ EDR logs suspicious PSExec execution                       |
| 18:08 | ğŸŸ¡ SOC confirms stolen domain creds used in command line args |
| 18:15 | ğŸ›‘ Workstation isolated, domain account reset                 |
| 18:40 | ğŸ” IOC sweep â†’ no persistence/malware on file server          |
| 19:00 | âœ… Incident closed after containment & credential rotation     |

_______________________________________________________________________________________________________________________________________________

ğŸ“‚ Artifacts (Synthetic / Anonymized)

EDR Process Log:

{
  "time": "2025-06-22T18:04:11Z",
  "host": "FIN-WKS23",
  "process": "psexec.exe",
  "commandLine": "psexec.exe \\\\FILE-SRV01 -u DOMAIN\\admin -p ******** cmd.exe /c whoami",
  "user": "DOMAIN\\admin",
  "target": "FILE-SRV01",
  "action": "alert"
}

Windows Security Log (File Server):

{
  "time": "2025-06-22T18:05:02Z",
  "eventID": 4624,
  "logonType": 3,
  "account": "DOMAIN\\admin",
  "srcHost": "FIN-WKS23",
  "targetHost": "FILE-SRV01"
}

_______________________________________________________________________________________________________________________________________________

ğŸ’» Attacker Commands (Reconstructed, Synthetic)

# Example lateral move attempt
psexec.exe \\FILE-SRV01 -u DOMAIN\admin -p <stolen_pass> cmd.exe /c whoami

# Potential follow-on usage
psexec.exe \\FILE-SRV01 -u DOMAIN\admin -p <stolen_pass> cmd.exe /c net user attacker P@ss123 /add
psexec.exe \\FILE-SRV01 -u DOMAIN\admin -p <stolen_pass> cmd.exe /c net localgroup administrators attacker /add

_______________________________________________________________________________________________________________________________________________

ğŸ§¾ IOCs (Synthetic)

| Type    | Value                     | Source        | Status      |
| ------- | ------------------------- | ------------- | ----------- |
| Host    | FIN-WKS23                 | EDR / Sysmon  | Compromised |
| Host    | FILE-SRV01                | Security Logs | Targeted    |
| Tool    | psexec.exe (Sysinternals) | EDR logs      | Abused      |
| Account | DOMAIN\admin              | EDR + WinLogs | Abused      |

_______________________________________________________________________________________________________________________________________________

ğŸ”‘ Key Findings

ğŸš¨ PSExec launched from non-IT workstation.

ğŸš¨ Stolen domain creds confirmed.

ğŸ›‘ No malware dropped / no persistence.

ğŸ›¡ï¸ Fast SOC response â†’ prevented escalation.

_______________________________________________________________________________________________________________________________________________

ğŸ—‚ï¸ MITRE ATT&CK Mapping

T1021.002 â€“ SMB/Windows Admin Shares

T1569.002 â€“ Remote Service Execution (PSExec)

T1078 â€“ Valid Accounts

_______________________________________________________________________________________________________________________________________________

ğŸ‘€ Detection Use Cases

ğŸš¨ Alert on psexec.exe execution from non-admin hosts.

ğŸš¨ Correlate domain admin logins with workstation events.

ğŸ›  Detect anomalous logon patterns (finance dept â†’ servers).

_______________________________________________________________________________________________________________________________________________

ğŸ›¡ï¸ Response Actions

âŒ Workstation FIN-WKS23 isolated from domain.

ğŸ”’ Domain admin account reset + creds rotated.

ğŸ” IOC sweep â†’ confirmed no persistence.

ğŸ“‘ SOC added rule to block PSExec except for IT hosts.

_______________________________________________________________________________________________________________________________________________

ğŸ›¡ï¸ Recommendations

Restrict PSExec to IT-admin controlled hosts.

Enforce just-in-time (JIT) access for privileged accounts.

Enable Sysmon logging for remote execution tools.

Train analysts to treat PSExec + unusual host as ğŸš¨ critical.
