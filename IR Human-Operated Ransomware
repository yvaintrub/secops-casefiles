# ğŸ›¡ Demo Case: Human-Operated Ransomware (Anonymized)

## ğŸ“Œ Executive Summary
This case describes a **multi-stage ransomware incident**.  
The attacker gained access via an exposed **RDP service**, escalated to domain admin, moved laterally with **Cobalt Strike**, and deployed ransomware domain-wide through **Group Policy**.  
They also exfiltrated sensitive files before encryption.  

**ğŸ¯ Outcome:** confirmed data exfiltration, ransomware deployment at scale, and delayed detection.

---

## ğŸ–¼ Attack Flow (ASCII Diagram)

                     +-------------------+
                     |   Attacker Host   |
                     +-------------------+
                               |
                               v
                     +-------------------+
                     | ğŸ”´ RDP brute-force |
                     +-------------------+
                               |
                               v
                     +-----------------------+
                     | Initial Workstation   |
                     +-----------------------+
                               |
                               v
                 +----------------------------+
                 | ğŸŸ¡ LSASS dump (Mimikatz)   |
                 +----------------------------+
                               |
                               v
                     +-----------------------+
                     | Domain Admin Creds    |
                     +-----------------------+
                               |
                               v
                     +-----------------------+
                     | ğŸ”´ Cobalt Strike      |
                     |     beacon            |
                     +-----------------------+
                               |
                               v
                     +-----------------------+
                     |   Domain Controller   |
                     +-----------------------+
                        /              \
                       /                \
                      v                  v
   +---------------------------+   +----------------------+
   | ğŸ”´ Group Policy Push      |   | ğŸŸ¢ FTP Exfiltration  |
   +---------------------------+   +----------------------+
              |
              v
   +---------------------------+
   | ğŸ”’ Endpoints Encrypted    |
   +---------------------------+

## ğŸ“– Attack Narrative

### Stage 1 â€“ Initial Access & Escalation
- ğŸ”´ **RDP brute-force** â†’ successful login.  
- ğŸŸ¡ **Privilege escalation** via DLL hijack + LSASS dump (Mimikatz).  
- ğŸŸ¡ Domain admin credentials harvested.  

### Stage 2 â€“ Lateral Movement & Recon
- ğŸ”´ **Cobalt Strike beacon** deployed for C2.  
- ğŸŸ¡ SMB shares + stolen creds used for pivot.  
- ğŸŸ¢ **PowerView** run for domain reconnaissance.  

### Stage 3 â€“ Ransomware Deployment & Exfiltration
- ğŸ”´ **Group Policy** modified to push ransomware.  
- ğŸ”´ **Sensitive files exfiltrated via FTP**.  
- ğŸ”´ **Encryption triggered** â†’ ransom notes deployed.  

---

## â±ï¸ Timeline (UTC)

| Time   | Event                                      |
|--------|--------------------------------------------|
| T0     | ğŸ”´ RDP brute-force success                 |
| +1 hr  | ğŸŸ¡ LSASS dump â†’ admin creds harvested       |
| +2 hr  | ğŸ”´ Cobalt Strike beacon active              |
| +4 hr  | ğŸ”´ GPO used to deploy ransomware            |
| +5 hr  | ğŸ”´ Data exfiltration via FTP                |
| +6 hr  | ğŸ”´ Ransomware execution, ransom dropped     |

---

## ğŸ”‘ Key Findings
- ğŸ”´ Exposed RDP allowed stealthy entry.  
- ğŸŸ¡ Privilege escalation â†’ domain admin compromise.  
- ğŸ”´ Ransomware distributed via Group Policy.  
- ğŸ”´ Data exfiltration confirmed before encryption.  
- ğŸŸ¡ Detection & response were delayed.  

---

## ğŸ—‚ï¸ MITRE ATT&CK Mapping
- **T1210** â€“ Exploitation of Remote Services (RDP)  
- **T1003** â€“ OS Credential Dumping (LSASS / Mimikatz)  
- **T1071.001** â€“ Application Layer Protocol (Cobalt Strike C2)  
- **T1486** â€“ Data Encrypted for Impact (Ransomware)  
- **T1020** â€“ Automated Exfiltration (FTP)  
- **T1069** â€“ Permission Group Discovery (PowerView)  

---

## ğŸ‘€ Detection Use Cases
- ğŸš¨ Alert on unusual external RDP logins.  
- ğŸŸ¡ Detect LSASS memory access (Mimikatz-like behavior).  
- ğŸ”´ Monitor **Group Policy changes** outside maintenance windows.  
- ğŸ”´ Outbound FTP transfers to unknown hosts.  
- ğŸ”´ Mass file access & encryption behavior at endpoints.  

---

## ğŸ›¡ï¸ Recommendations
- Block or restrict RDP; enforce MFA.  
- Harden LSASS against credential dumping.  
- Audit & alert on GPO modifications.  
- Monitor outbound traffic for exfiltration.  
- Deploy ransomware-specific detections in SIEM/EDR.  
